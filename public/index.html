<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      /* Scroll container for table rows */
      .scroll-area {
        max-height: 360px; /* Adjust as you like */
        overflow-y: auto;
      }

      /* Hide scrollbar for WebKit (Chrome, Edge, Safari) */
      .scroll-area::-webkit-scrollbar {
        display: none;
      }

      /* Hide scrollbar for Firefox + older Edge */
      .scroll-area {
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
      }
    </style>
    <style>
      /* Scroll container for table rows (you already had something similar; keep or adjust) */
      .scroll-area {
        max-height: 360px;
        overflow-y: auto;
      }
      .scroll-area::-webkit-scrollbar {
        display: none;
      }
      .scroll-area {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* Modal animations */
      .modal-backdrop {
        opacity: 0;
        transition: opacity 0.18s ease-out;
      }
      .modal-backdrop-open {
        opacity: 1;
      }
      .modal-panel-animated {
        transform: scale(0.95);
        opacity: 0;
        transition: transform 0.18s ease-out, opacity 0.18s ease-out;
        transform-origin: center;
      }
      .modal-panel-open {
        transform: scale(1);
        opacity: 1;
      }

      /* Toasts */
      .toast-enter {
        transform: translateY(8px);
        opacity: 0;
      }
      .toast-enter-active {
        transform: translateY(0);
        opacity: 1;
        transition: transform 0.18s ease-out, opacity 0.18s ease-out;
      }
      .toast-exit {
        transform: translateY(0);
        opacity: 1;
      }
      .toast-exit-active {
        transform: translateY(8px);
        opacity: 0;
        transition: transform 0.18s ease-out, opacity 0.18s ease-out;
      }
    </style>
    <link
      rel="icon"
      href="data:image/svg+xml,
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
    <text y='0.9em' font-size='90'>üîó</text>
  </svg>
"
    />

    <meta charset="utf-8" />
    <title>TinyLink</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
      // Enable Tailwind dark mode via "dark" class
      tailwind.config = {
        darkMode: "class",
      };
    </script>

    <script>
      // Initialize theme from localStorage before paint (avoid flash)
      (function () {
        try {
          const stored = localStorage.getItem("theme");
          if (stored === "dark") {
            document.documentElement.classList.add("dark");
          }
        } catch (e) {}
      })();
    </script>
  </head>

  <body
    class="bg-slate-100 dark:bg-slate-950 text-slate-900 dark:text-slate-100 min-h-screen overflow-hidden"
  >
    <!-- Modern fixed header -->
    <header class="fixed top-0 inset-x-0 z-50">
      <div
        class="backdrop-blur-md bg-white/70 dark:bg-slate-900/70 border-b border-slate-200/80 dark:border-slate-800/80"
      >
        <div
          class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-4"
        >
          <!-- Left: logo + breadcrumb -->
          <div class="flex items-center gap-3">
            <!-- Logo / icon -->
            <div
              class="h-9 w-9 rounded-xl bg-blue-600 text-white flex items-center justify-center font-semibold shadow-sm"
            >
              TL
            </div>
            <div class="flex flex-col">
              <div class="flex items-center gap-2">
                <span
                  class="text-sm font-semibold tracking-tight text-slate-800 dark:text-slate-100"
                  >TinyLink</span
                >
                <span
                  class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-blue-50 text-blue-700 dark:bg-blue-900/40 dark:text-blue-200"
                  >Dashboard</span
                >
              </div>
              <div
                class="text-[11px] text-slate-500 dark:text-slate-400 flex items-center gap-1"
              ></div>
            </div>
          </div>

          <!-- Right: theme toggle + New Link button -->
          <div class="flex items-center gap-3">
            <!-- Dark / light toggle -->
            <button
              id="theme-toggle"
              type="button"
              class="h-9 w-9 rounded-full border border-slate-200/80 dark:border-slate-700/80 flex items-center justify-center text-slate-600 dark:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 transition"
              aria-label="Toggle dark mode"
            >
              <span id="icon-sun" class="text-lg hidden">‚òÄÔ∏è</span>
              <span id="icon-moon" class="text-lg">üåô</span>
            </button>

            <!-- New Link button (opens modal) -->
            <button
              id="open-create-modal"
              type="button"
              class="inline-flex items-center gap-2 rounded-full bg-blue-600 text-white text-sm font-medium px-4 py-2 shadow-sm hover:bg-blue-700 active:scale-[0.98] transition"
            >
              <span class="text-base leading-none">Ôºã</span>
              <span>New Link</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Create Link Modal -->
    <div
      id="create-modal"
      class="modal-backdrop fixed inset-0 z-40 hidden items-center justify-center bg-slate-900/40"
    >
      <div
        id="create-modal-panel"
        class="modal-panel-animated bg-white dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-lg mx-4 border border-slate-200/80 dark:border-slate-800/80"
      >
        <div class="px-6 pt-5 pb-3 flex items-center justify-between">
          <h2 class="text-lg font-semibold text-slate-800 dark:text-slate-50">
            Create Short Link
          </h2>
          <button
            id="close-create-modal"
            type="button"
            class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 text-xl leading-none"
            aria-label="Close"
          >
            &times;
          </button>
        </div>
        <div class="px-6 pb-6">
          <p class="text-sm text-slate-500 dark:text-slate-400 mb-4">
            Paste a long URL and optionally choose your own shortcode. Short
            links will appear instantly in your dashboard below.
          </p>

          <!-- Same form as before, just moved into modal -->
          <form id="create-form" class="flex flex-col gap-4">
            <input
              id="targetUrl"
              type="text"
              placeholder="Enter target URL (https://...)"
              class="border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500/70 focus:border-blue-500/70 p-3 rounded-lg text-sm"
              required
            />

            <input
              id="customCode"
              type="text"
              placeholder="Optional custom code (6‚Äì8 letters/numbers)"
              class="border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500/70 focus:border-blue-500/70 p-3 rounded-lg text-sm"
            />

            <button
              class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 active:scale-[0.99] transition self-end"
              type="submit"
            >
              Create
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Link Details Modal -->
    <div
      id="details-modal"
      class="modal-backdrop fixed inset-0 z-40 hidden items-center justify-center bg-slate-900/40"
    >
      <div
        id="details-modal-panel"
        class="modal-panel-animated bg-white dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-lg mx-4 border border-slate-200/80 dark:border-slate-800/80"
      >
        <div class="px-6 pt-5 pb-3 flex items-center justify-between">
          <h2 class="text-lg font-semibold text-slate-800 dark:text-slate-50">
            Link Details
          </h2>
          <button
            id="close-details-modal"
            type="button"
            class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 text-xl leading-none"
            aria-label="Close"
          >
            &times;
          </button>
        </div>

        <div id="details-content" class="px-6 pb-6 text-sm">
          <!-- JS will fill details here -->
          <p class="text-slate-500">Loading...</p>
        </div>
      </div>
    </div>
    <!-- Delete Confirmation Modal -->
    <div
      id="delete-modal"
      class="modal-backdrop fixed inset-0 z-40 hidden items-center justify-center bg-slate-900/40"
    >
      <div
        id="delete-modal-panel"
        class="modal-panel-animated bg-white dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-sm mx-4 border border-slate-200/80 dark:border-slate-800/80 p-6"
      >
        <h2
          class="text-lg font-semibold text-slate-800 dark:text-slate-50 mb-3"
        >
          Delete Link?
        </h2>

        <p class="text-sm text-slate-600 dark:text-slate-300 mb-6">
          This action is permanent. The short link will stop working
          immediately.
        </p>

        <div class="flex justify-end gap-3">
          <button
            id="delete-cancel-btn"
            class="px-4 py-2 rounded-lg text-sm bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600"
          >
            Cancel
          </button>

          <button
            id="delete-confirm-btn"
            class="px-4 py-2 rounded-lg text-sm bg-red-600 text-white hover:bg-red-700"
          >
            Delete
          </button>
        </div>
      </div>
    </div>

    <!-- Main content -->
    <main
      class="max-w-5xl mx-auto px-4 pt-20 pb-4 space-y-2 h-[calc(100vh-80px)] flex flex-col"
    >
      <!-- Overview card -->
      <section>
        <div
          class="bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm rounded-2xl shadow-sm p-5 border border-slate-200/70 dark:border-slate-800/80"
        >
          <h2 class="text-lg font-semibold mb-1 text-slate-800 dark:text-white">
            Overview
          </h2>
          <p class="text-sm text-slate-500 dark:text-slate-400">
            Use the <span class="font-medium">‚ÄúNew Link‚Äù</span> button in the
            header to create short links. Your links and live click statistics
            appear in the table below.
          </p>
        </div>
      </section>

      <!-- Links table -->
      <!-- Links table -->
      <section class="flex-1">
        <div
          class="bg-white dark:bg-slate-900 rounded-2xl shadow p-6 border border-slate-200 dark:border-slate-800 h-full flex flex-col"
        >
          <div
            class="mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"
          >
            <div>
              <h2
                class="text-xl font-semibold text-slate-800 dark:text-slate-50"
              >
                Your Short Links
              </h2>
              <p class="text-xs text-slate-500 dark:text-slate-400">
                Click a code to view detailed stats, or use the short URL to
                redirect.
              </p>
            </div>

            <!-- Search / filter -->
            <div class="w-full sm:w-64">
              <div class="relative">
                <input
                  id="search-input"
                  type="text"
                  placeholder="Search by code or URL..."
                  class="w-full pl-9 pr-3 py-2 rounded-full border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/70 focus:border-blue-500/70 text-slate-800 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500"
                />
                <span
                  class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 text-sm"
                >
                  üîç
                </span>
              </div>
            </div>
          </div>

          <!-- Scrollable area just for the table body -->
          <div
            class="overflow-x-auto rounded-xl border border-slate-100 dark:border-slate-800 flex-1"
          >
            <table class="w-full text-left border-collapse text-sm">
              <thead
                class="bg-slate-100/80 dark:bg-slate-800/80 text-slate-700 dark:text-slate-300"
              >
                <tr>
                  <th class="p-3">Code</th>
                  <th class="p-3">Target URL</th>
                  <th class="p-3 text-center">Clicks</th>
                  <th class="p-3 text-center">Last Clicked</th>
                  <th class="p-3 text-center">Actions</th>
                </tr>
              </thead>
            </table>

            <!-- This div is the only vertically scrollable area -->
            <div class="scroll-area">
              <table class="w-full text-left border-collapse text-sm">
                <tbody id="links-table-body" class="bg-white dark:bg-slate-900">
                  <!-- Rows injected by dashboard.js -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Existing dashboard JS (API logic, table, etc.) -->
    <script src="dashboard.js"></script>
    <!-- Toast container -->
    <div
      id="toast-container"
      class="fixed bottom-4 right-4 z-[60] flex flex-col gap-2 items-end"
    ></div>

    <!-- Header: theme toggle + modal behavior -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- Theme toggle ---
        const toggleBtn = document.getElementById("theme-toggle");
        const iconSun = document.getElementById("icon-sun");
        const iconMoon = document.getElementById("icon-moon");

        function updateThemeIcons() {
          const isDark = document.documentElement.classList.contains("dark");
          iconSun.classList.toggle("hidden", !isDark);
          iconMoon.classList.toggle("hidden", isDark);
        }

        toggleBtn.addEventListener("click", () => {
          const isDark = document.documentElement.classList.toggle("dark");
          try {
            localStorage.setItem("theme", isDark ? "dark" : "light");
          } catch (e) {}
          updateThemeIcons();
        });

        updateThemeIcons();

        // --- Create modal open/close with animation ---
        const modal = document.getElementById("create-modal");
        const modalPanel = document.getElementById("create-modal-panel");
        const openBtn = document.getElementById("open-create-modal");
        const closeBtn = document.getElementById("close-create-modal");

        function openCreateModal() {
          modal.classList.remove("hidden");
          modal.classList.add("flex", "modal-backdrop-open");

          // allow layout to apply, then animate panel
          requestAnimationFrame(() => {
            modalPanel.classList.add("modal-panel-open");
          });
        }

        function closeCreateModal() {
          modal.classList.remove("modal-backdrop-open");
          modalPanel.classList.remove("modal-panel-open");

          // wait for animation to finish, then hide
          setTimeout(() => {
            modal.classList.add("hidden");
            modal.classList.remove("flex");
          }, 180);
        }

        openBtn.addEventListener("click", openCreateModal);
        closeBtn.addEventListener("click", closeCreateModal);

        // Close when clicking backdrop
        modal.addEventListener("click", (e) => {
          if (e.target.id === "create-modal") {
            closeCreateModal();
          }
        });
      });
    </script>
  </body>
</html>
